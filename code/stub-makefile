chez := scheme
chez-args := -q example.scm

guile := guile
guile-args := --no-auto-compile -q -l example.scm -c

run-test = \
	"(when (eq? 'failure (test 'input 'output)) (error '$(1) \"incorrect implementation\"))"

help :
	echo "Test your solutions from the command line by calling make check-* where * is the name of your scheme."

check-all : check-chez check-guile

check-chez :
	echo $(call run-test, $@) | $(chez) $(chez-args)

check-guile :
	$(guile) $(guile-args) $(call run-test, $@)

.PHONY : help check-all check-chez check-guile
